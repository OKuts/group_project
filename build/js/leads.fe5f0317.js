!function(){var e,t={1493:function(e,t,n){"use strict";n(5666),n(8309),n(1539),n(8674),n(3371);var r=n(8901),a=n.n(r),o="https://lab.lectrum.io/js2/api/crm";function c(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){c(o,r,a,i,u,"next",e)}function u(e){c(o,r,a,i,u,"throw",e)}i(void 0)}))}}var u=Object.freeze({verifyToken:function(e){return i(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(o,"/auth"),{method:"GET",headers:{"x-token":e}});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})))()},getUserName:function(e){return i(regeneratorRuntime.mark((function t(){var n,r,c,i,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(o,"/profile"),{method:"GET",headers:{"x-token":e}});case 2:if((n=t.sent).ok){t.next=12;break}return t.next=6,n.json();case 6:throw r=t.sent,c=r.message,a().error(c,"Ошибка!"),localStorage.removeItem("token"),location.href="/",new Error(c);case 12:return t.next=14,n.json();case 14:return i=t.sent,u=i.data,t.abrupt("return",u);case 17:case"end":return t.stop()}}),t)})))()}});function s(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}var f=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("token"))){e.next=14;break}return e.prev=2,e.next=5,u.getUserName(t);case 5:n=e.sent,localStorage.setItem("profile",JSON.stringify(n)),document.querySelector(".profile__name").textContent=n.name,document.querySelector(".profile__email").textContent=n.email,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){s(o,r,a,c,i,"next",e)}function i(e){s(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(){return t.apply(this,arguments)}}();function l(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}var p=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("token"))){e.next=14;break}return e.prev=2,e.next=5,u.verifyToken(t);case 5:"/"!==location.pathname&&"/sign-up.html"!==location.pathname||(location.href="/dashboard.html"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),localStorage.removeItem("token"),location.href="/";case 12:e.next=15;break;case 14:"/"!==location.pathname&&"/sign-up.html"!==location.pathname&&(location.href="/");case 15:case"end":return e.stop()}}),e,null,[[2,8]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){l(o,r,a,c,i,"next",e)}function i(e){l(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(){return t.apply(this,arguments)}}(),d={"Высокий":"green","Низкий":"yellow","Срочный":"red"},v=(n(4747),n(6210),n(561),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948),n(7042),n(1038),n(7941),n(7327),n(5003),n(9337),n(2222),document.getElementById("leadsWrap"));function h(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}var m,g,y=Object.freeze({updateLead:(m=regeneratorRuntime.mark((function e(t,n,r){var a,c,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/leads/").concat(r),{method:"PUT",headers:{"Content-Type":"application/json","x-token":t},body:n});case 2:return a=e.sent,e.next=5,a.json();case 5:return c=e.sent,i=c.data,e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})),g=function(){var e=this,t=arguments;return new Promise((function(n,r){var a=m.apply(e,t);function o(e){h(a,n,r,o,c,"next",e)}function c(e){h(a,n,r,o,c,"throw",e)}o(void 0)}))},function(e,t,n){return g.apply(this,arguments)})});function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}var j={new:"Новые сделки",inProgress:"На стадии завершения",done:"Закрытые"},_=function e(t){Object.getOwnPropertyNames(t).reverse().forEach((function(e){var n,r,a,o;v.insertAdjacentHTML("afterbegin",(n=t[e],r=e,a={year:"numeric",month:"long",day:"numeric"},o='\n    <div class="tasks__column">\n      <div class="column__header flex">\n        <h2>'.concat(j[e],' <span id="newCount" class="count">').concat(n.length,'</span></h2>\n        <img src="img/icon/icons-edit.svg" alt="" class="column__control">\n        <img src="img/icon/icons-delete.svg" alt="" class="column__control">\n            <div class="btn__add__task">\n              <img src="img/icon/plus.svg" alt="">\n            </div>\n      </div>\n      <div data-id="').concat(r,'" class="task task__dnd show"></div>\n    '),n.forEach((function(e,t){o="".concat(o,'\n       <div class="task task__block ').concat(d[e.status],' draggableElement" \n            data-num=').concat(t," \n            data-hash=").concat(e.hash," \n            data-leadname=").concat(r,' draggable="true">\n    \t\t\t<h2 class="task__title">').concat(e.title,'</h2>\n    \t\t\t<p class="task__deadline">Закрыть до:\n    \t\t\t  <span>').concat(new Date(e.deadline).toLocaleString("ru-Ru",a),'</span>\n    \t\t\t</p>\n    \t\t\t<div class="task__executor flex">\n    \t\t\t\t<img src="img/icon/ava-empty.svg" class="executor__img" alt="">\n    \t\t\t\t<p class="executor__name">').concat(e.manager,'</p>\n    \t\t\t</div>\n    \t\t\t<img src="img/icon/icons-delete.svg" class="remove__icon" alt="">\n\n    \t\t\t<p class="price">$').concat(e.amount,"</p>\n    \t\t</div>\n\n    ")})),"".concat(o,"</div>")))}));var n=document.querySelectorAll(".task__dnd"),r=v.querySelectorAll(".draggableElement");n.forEach((function(n){n.addEventListener("dragover",(function(e){e.preventDefault()})),n.addEventListener("drop",function(){var n=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){O(o,r,a,c,i,"next",e)}function i(e){O(o,r,a,c,i,"throw",e)}c(void 0)}))}}(regeneratorRuntime.mark((function n(r){var a,o,c,i,u,s,f,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.preventDefault(),a=localStorage.getItem(a),o=r.dataTransfer.getData("num"),c=r.dataTransfer.getData("leadName"),i=r.dataTransfer.getData("hash"),u=r.target.dataset.id,s=t[c].splice(o,1),d=1,f=function(e){if(Array.isArray(e))return e}(p=s)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],c=!0,i=!1;try{for(n=n.call(e);!(c=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);c=!0);}catch(e){i=!0,a=e}finally{try{c||null==n.return||n.return()}finally{if(i)throw a}}return o}}(p,d)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}(p,d)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),l=f[0],t[u].unshift(l),n.prev=8,n.next=11,y.updateLead(a,u,i);case 11:v.innerHTML="",e(b({},t)),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(8),console.error(n.t0.message);case 18:case"end":return n.stop()}var p,d}),n,null,[[8,15]])})));return function(e){return n.apply(this,arguments)}}())})),r.forEach((function(e){e.addEventListener("dragstart",(function(e){e.dataTransfer.setData("hash",e.target.dataset.hash),e.dataTransfer.setData("num",e.target.dataset.num),e.dataTransfer.setData("leadName",e.target.dataset.leadname)}))}))};function P(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){P(o,r,a,c,i,"next",e)}function i(e){P(o,r,a,c,i,"throw",e)}c(void 0)}))}}var R,S,T,D,I,A=Object.freeze({addLead:(I=E(regeneratorRuntime.mark((function e(t,n){var r,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/leads"),{method:"POST",headers:{"Content-Type":"application/json","x-token":t},body:n});case 2:return r=e.sent,e.next=5,r.json();case 5:return a=e.sent,c=a.data,e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return I.apply(this,arguments)}),loadPriorities:(D=E(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/settings/tags"),{headers:{"x-token":t}});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,a=r.data,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)}))),function(e){return D.apply(this,arguments)}),loadClients:(T=E(regeneratorRuntime.mark((function e(t,n,r){var a,c,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/clients?limit=").concat(n,"&page=").concat(r),{headers:{"x-token":t}});case 2:return a=e.sent,e.next=5,a.json();case 5:return c=e.sent,i=c.data,e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)}))),function(e,t,n){return T.apply(this,arguments)}),loadUsers:(S=E(regeneratorRuntime.mark((function e(t,n,r){var a,c,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/users?limit=").concat(n,"&page=").concat(r),{headers:{"x-token":t}});case 2:return a=e.sent,e.next=5,a.json();case 5:return c=e.sent,i=c.data,e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)}))),function(e,t,n){return S.apply(this,arguments)}),loadLeads:(R=E(regeneratorRuntime.mark((function e(t,n,r){var a,c,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/leads?limit=").concat(n,"&page=").concat(r),{headers:{"x-token":t}});case 2:return a=e.sent,e.next=5,a.json();case 5:return c=e.sent,i=c.data,e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)}))),function(e,t,n){return R.apply(this,arguments)})});function L(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}var N=function(){var e=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){L(o,r,a,c,i,"next",e)}function i(e){L(o,r,a,c,i,"throw",e)}c(void 0)}))}}(regeneratorRuntime.mark((function e(){var t,n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("token"))){e.next=16;break}return e.prev=2,e.next=5,A.loadLeads(t,15,1);case 5:n=e.sent,r=n.docs,a={},r.forEach((function(e){a[e.pipeline]||(a[e.pipeline]=[]),a[e.pipeline].push(e)})),delete a["in-progress"],_(a),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),console.error(e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}();p(),document.querySelector(".logout__btn").onclick=function(){localStorage.removeItem("token"),location.href="/"},f(),N()},8533:function(e,t,n){"use strict";var r=n(2092).forEach,a=n(9341)("forEach");e.exports=a?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},9341:function(e,t,n){"use strict";var r=n(7293);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){throw 1},1)}))}},1156:function(e,t,n){var r=n(5656),a=n(8006).f,o={}.toString,c="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return c&&"[object Window]"==o.call(e)?function(e){try{return a(e)}catch(e){return c.slice()}}(e):a(r(e))}},7327:function(e,t,n){"use strict";var r=n(2109),a=n(2092).filter;r({target:"Array",proto:!0,forced:!n(1194)("filter")},{filter:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},561:function(e,t,n){"use strict";var r=n(2109),a=n(1400),o=n(9958),c=n(7466),i=n(7908),u=n(5417),s=n(6135),f=n(1194)("splice"),l=Math.max,p=Math.min,d=9007199254740991,v="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!f},{splice:function(e,t){var n,r,f,h,m,g,y=i(this),w=c(y.length),b=a(e,w),x=arguments.length;if(0===x?n=r=0:1===x?(n=0,r=w-b):(n=x-2,r=p(l(o(t),0),w-b)),w+n-r>d)throw TypeError(v);for(f=u(y,r),h=0;h<r;h++)(m=b+h)in y&&s(f,h,y[m]);if(f.length=r,n<r){for(h=b;h<w-r;h++)g=h+n,(m=h+r)in y?y[g]=y[m]:delete y[g];for(h=w;h>w-r+n;h--)delete y[h-1]}else if(n>r)for(h=w-r;h>b;h--)g=h+n-1,(m=h+r-1)in y?y[g]=y[m]:delete y[g];for(h=0;h<n;h++)y[h+b]=arguments[h+2];return y.length=w-r+n,f}})},5003:function(e,t,n){var r=n(2109),a=n(7293),o=n(5656),c=n(1236).f,i=n(9781),u=a((function(){c(1)}));r({target:"Object",stat:!0,forced:!i||u,sham:!i},{getOwnPropertyDescriptor:function(e,t){return c(o(e),t)}})},9337:function(e,t,n){var r=n(2109),a=n(9781),o=n(3887),c=n(5656),i=n(1236),u=n(6135);r({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(e){for(var t,n,r=c(e),a=i.f,s=o(r),f={},l=0;s.length>l;)void 0!==(n=a(r,t=s[l++]))&&u(f,t,n);return f}})},6210:function(e,t,n){var r=n(2109),a=n(7293),o=n(1156).f;r({target:"Object",stat:!0,forced:a((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:o})},7941:function(e,t,n){var r=n(2109),a=n(7908),o=n(1956);r({target:"Object",stat:!0,forced:n(7293)((function(){o(1)}))},{keys:function(e){return o(a(e))}})},4747:function(e,t,n){var r=n(7854),a=n(8324),o=n(8533),c=n(8880);for(var i in a){var u=r[i],s=u&&u.prototype;if(s&&s.forEach!==o)try{c(s,"forEach",o)}catch(e){s.forEach=o}}}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var o=n[e]={exports:{}};return t[e].call(o.exports,o,o.exports,r),o.exports}r.m=t,r.amdD=function(){throw new Error("define cannot be used indirect")},e=[],r.O=function(t,n,a,o){if(!n){var c=1/0;for(f=0;f<e.length;f++){n=e[f][0],a=e[f][1],o=e[f][2];for(var i=!0,u=0;u<n.length;u++)(!1&o||c>=o)&&Object.keys(r.O).every((function(e){return r.O[e](n[u])}))?n.splice(u--,1):(i=!1,o<c&&(c=o));if(i){e.splice(f--,1);var s=a();void 0!==s&&(t=s)}}return t}o=o||0;for(var f=e.length;f>0&&e[f-1][2]>o;f--)e[f]=e[f-1];e[f]=[n,a,o]},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={191:0,901:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,o,c=n[0],i=n[1],u=n[2],s=0;for(a in i)r.o(i,a)&&(r.m[a]=i[a]);if(u)var f=u(r);for(t&&t(n);s<c.length;s++)o=c[s],r.o(e,o)&&e[o]&&e[o][0](),e[c[s]]=0;return r.O(f)},n=self.webpackChunkjs_personal_projects=self.webpackChunkjs_personal_projects||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var a=r.O(void 0,[773,165,747,901],(function(){return r(1493)}));a=r.O(a)}();